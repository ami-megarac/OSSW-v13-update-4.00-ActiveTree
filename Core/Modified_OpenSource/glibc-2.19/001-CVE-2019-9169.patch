diff -Naur glibc_old/posix/regexec.c glibc_new/posix/regexec.c
--- glibc_old/posix/regexec.c	2019-10-08 15:58:18.974694772 +0800
+++ glibc_new/posix/regexec.c	2019-10-08 16:00:57.904696061 +0800
@@ -1330,8 +1330,10 @@
 	      else if (naccepted)
 		{
 		  char *buf = (char *) re_string_get_buffer (&mctx->input);
-		  if (memcmp (buf + regs[subexp_idx].rm_so, buf + *pidx,
-			      naccepted) != 0)
+                 if (mctx->input.valid_len - *pidx < naccepted
+                     || (memcmp (buf + regs[subexp_idx].rm_so, buf + *pidx,
+                                 naccepted)
+                         != 0))
 		    return -1;
 		}
 	    }
