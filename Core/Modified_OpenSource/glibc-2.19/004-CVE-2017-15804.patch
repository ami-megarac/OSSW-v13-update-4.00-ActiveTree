diff -Naur glibc_old/posix/glob.c glibc_new/posix/glob.c
--- glibc_old/posix/glob.c	2019-10-08 16:11:13.489628099 +0800
+++ glibc_new/posix/glob.c	2019-10-08 16:12:41.244642238 +0800
@@ -839,11 +839,11 @@
 		  char *p = mempcpy (newp, dirname + 1,
 				     unescape - dirname - 1);
 		  char *q = unescape;
-		  while (*q != '\0')
+		  while (q != end_name)
 		    {
 		      if (*q == '\\')
 			{
-			  if (q[1] == '\0')
+			  if (q + 1 == end_name)
 			    {
 			      /* "~fo\\o\\" unescape to user_name "foo\\",
 				 but "~fo\\o\\/" unescape to user_name
