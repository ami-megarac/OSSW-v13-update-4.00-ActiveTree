diff -Naur net-snmp-5.8_org/agent/mibgroup/agent/nsLogging.c net-snmp-5.8/agent/mibgroup/agent/nsLogging.c
--- net-snmp-5.8_org/agent/mibgroup/agent/nsLogging.c	2018-07-16 22:33:40.000000000 +0800
+++ net-snmp-5.8/agent/mibgroup/agent/nsLogging.c	2022-09-13 11:34:24.201596000 +0800
@@ -147,6 +147,8 @@
                 continue;
             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);
             table_info  =                netsnmp_extract_table_info(request);
+            if (!table_info || !table_info->indexes)
+                continue;
 
             switch (table_info->colnum) {
             case NSLOGGING_TYPE:
@@ -201,6 +203,8 @@
             }
             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);
             table_info  =                 netsnmp_extract_table_info(request);
+            if (!table_info || !table_info->indexes)
+                continue;
 
             switch (table_info->colnum) {
             case NSLOGGING_TYPE:
@@ -394,6 +398,8 @@
                 continue;
             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);
             table_info  =                 netsnmp_extract_table_info(request);
+            if (!table_info || !table_info->indexes)
+                continue;
 
             switch (table_info->colnum) {
             case NSLOGGING_TYPE:
diff -Naur net-snmp-5.8_org/agent/mibgroup/agent/nsVacmAccessTable.c net-snmp-5.8/agent/mibgroup/agent/nsVacmAccessTable.c
--- net-snmp-5.8_org/agent/mibgroup/agent/nsVacmAccessTable.c	2018-07-16 22:33:40.000000000 +0800
+++ net-snmp-5.8/agent/mibgroup/agent/nsVacmAccessTable.c	2022-09-13 11:29:26.682064000 +0800
@@ -170,9 +170,13 @@
             entry = (struct vacm_accessEntry *)
                 netsnmp_extract_iterator_context(request);
             table_info = netsnmp_extract_table_info(request);
+            if (!table_info || !table_info->indexes)
+                continue;
 
             /* Extract the authType token from the list of indexes */
             idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;
+            if (idx->val_len >= sizeof(atype))
+                continue;
             memset(atype, 0, sizeof(atype));
             memcpy(atype, (char *)idx->val.string, idx->val_len);
             viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);
@@ -212,6 +216,8 @@
             entry = (struct vacm_accessEntry *)
                 netsnmp_extract_iterator_context(request);
             table_info = netsnmp_extract_table_info(request);
+            if (!table_info || !table_info->indexes)
+                continue;
             ret = SNMP_ERR_NOERROR;
 
             switch (table_info->colnum) {
@@ -247,6 +253,8 @@
                  * Extract the authType token from the list of indexes
                  */
                 idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;
+                if (idx->val_len >= sizeof(atype))
+                    continue;
                 memset(atype, 0, sizeof(atype));
                 memcpy(atype, (char *)idx->val.string, idx->val_len);
                 viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);
@@ -294,8 +302,10 @@
                          idx = idx->next_variable;  model = *idx->val.integer;
                          idx = idx->next_variable;  level = *idx->val.integer;
                          entry = vacm_createAccessEntry( gName, cPrefix, model, level );
-                         entry->storageType = ST_NONVOLATILE;
-                         netsnmp_insert_iterator_context(request, (void*)entry);
+                         if (entry) {
+                             entry->storageType = ST_NONVOLATILE;
+                             netsnmp_insert_iterator_context(request, (void*)entry);
+                         }
                     }
                 }
             }
@@ -321,6 +331,8 @@
 
             /* Extract the authType token from the list of indexes */
             idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;
+            if (idx->val_len >= sizeof(atype))
+                continue;
             memset(atype, 0, sizeof(atype));
             memcpy(atype, (char *)idx->val.string, idx->val_len);
             viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);
diff -Naur net-snmp-5.8_org/agent/mibgroup/mibII/vacm_vars.c net-snmp-5.8/agent/mibgroup/mibII/vacm_vars.c
--- net-snmp-5.8_org/agent/mibgroup/mibII/vacm_vars.c	2018-07-16 22:33:40.000000000 +0800
+++ net-snmp-5.8/agent/mibgroup/mibII/vacm_vars.c	2022-09-13 11:22:48.301283000 +0800
@@ -997,6 +997,9 @@
         return 1;
     }
     groupNameL = oidIndex[0];
+    if ((groupNameL + 1) > (int) oidLen) {
+        return 1;
+    }
     contextPrefixL = oidIndex[groupNameL + 1];  /* the initial name length */
     if ((int) oidLen != groupNameL + contextPrefixL + 4) {
         return 1;
diff -Naur net-snmp-5.8_org/agent/mibgroup/snmpv3/usmUser.c net-snmp-5.8/agent/mibgroup/snmpv3/usmUser.c
--- net-snmp-5.8_org/agent/mibgroup/snmpv3/usmUser.c	2018-07-16 22:33:40.000000000 +0800
+++ net-snmp-5.8/agent/mibgroup/snmpv3/usmUser.c	2022-09-13 11:21:25.114624000 +0800
@@ -1507,8 +1507,6 @@
                 if (usmStatusCheck(uptr)) {
                     uptr->userStatus = RS_ACTIVE;
                 } else {
-                    SNMP_FREE(engineID);
-                    SNMP_FREE(newName);
                     return SNMP_ERR_INCONSISTENTVALUE;
                 }
             } else if (long_ret == RS_CREATEANDWAIT) {
diff -Naur net-snmp-5.8_org/agent/snmp_agent.c net-snmp-5.8/agent/snmp_agent.c
--- net-snmp-5.8_org/agent/snmp_agent.c	2018-07-16 22:33:40.000000000 +0800
+++ net-snmp-5.8/agent/snmp_agent.c	2022-09-13 11:20:09.254748000 +0800
@@ -2954,7 +2954,7 @@
         if (requests->status != SNMP_ERR_NOERROR &&
             (!look_for_specific || requests->status == look_for_specific)
             && (look_for_specific || asp->index == 0
-                || requests->index < asp->index)) {
+                || requests->index <= asp->index)) {
             asp->index = requests->index;
             asp->status = requests->status;
         }
