diff -Naur pcre3_old/pcre_compile.c pcre3_new/pcre_compile.c
--- pcre3_old/pcre_compile.c	2019-10-08 14:57:36.164157894 +0800
+++ pcre3_new/pcre_compile.c	2019-10-08 14:58:58.580213804 +0800
@@ -2454,7 +2454,7 @@
   if (c == OP_BRA  || c == OP_BRAPOS ||
       c == OP_CBRA || c == OP_CBRAPOS ||
       c == OP_ONCE || c == OP_ONCE_NC ||
-      c == OP_COND)
+      c == OP_COND || c == OP_SCOND)
     {
     BOOL empty_branch;
     if (GET(code, 1) == 0) return TRUE;    /* Hit unclosed bracket */
diff -Naur pcre3_old/testdata/testinput2 pcre3_new/testdata/testinput2
--- pcre3_old/testdata/testinput2	2019-10-08 14:57:44.407763379 +0800
+++ pcre3_new/testdata/testinput2	2019-10-08 14:58:49.500648304 +0800
@@ -4086,6 +4086,8 @@
 //
 \O1
 
+/^(?:(?(1)x|)+)+$()/BZ
+
 /[[:\\](?'abc')[a:]/
 
 "[[[.\xe8Nq\xffq\xff\xe0\x2|||::Nq\xffq\xff\xe0\x6\x2|||::[[[:[::::::[[[[[::::::::[:[[[:[:::[[[[[[[[[[[[:::::::::::::::::[[.\xe8Nq\xffq\xff\xe0\x2|||::Nq\xffq\xff\xe0\x6\x2|||::[[[:[::::::[[[[[::::::::[:[[[:[:::[[[[[[[[[[[[[[:::E[[[:[:[[:[:::[[:::E[[[:[:[[:'[:::::E[[[:[::::::[[[:[[[[[[[::E[[[:[::::::[[[:[[[[[[[[:[[::[::::[[:::::::[[:[[[[[[[:[[::[:[[:[~"
diff -Naur pcre3_old/testdata/testoutput2 pcre3_new/testdata/testoutput2
--- pcre3_old/testdata/testoutput2	2019-10-08 14:57:59.743029483 +0800
+++ pcre3_new/testdata/testoutput2	2019-10-08 14:58:34.241378536 +0800
@@ -14211,6 +14211,24 @@
 \O1
 Matched, but too many substrings
 
+/^(?:(?(1)x|)+)+$()/BZ
+------------------------------------------------------------------
+        Bra
+        ^
+        SBra
+        SCond
+      1 Cond ref
+        x
+        Alt
+        KetRmax
+        KetRmax
+        $
+        CBra 1
+        Ket
+        Ket
+        End
+------------------------------------------------------------------
+
 /[[:\\](?'abc')[a:]/
 
 "[[[.\xe8Nq\xffq\xff\xe0\x2|||::Nq\xffq\xff\xe0\x6\x2|||::[[[:[::::::[[[[[::::::::[:[[[:[:::[[[[[[[[[[[[:::::::::::::::::[[.\xe8Nq\xffq\xff\xe0\x2|||::Nq\xffq\xff\xe0\x6\x2|||::[[[:[::::::[[[[[::::::::[:[[[:[:::[[[[[[[[[[[[[[:::E[[[:[:[[:[:::[[:::E[[[:[:[[:'[:::::E[[[:[::::::[[[:[[[[[[[::E[[[:[::::::[[[:[[[[[[[[:[[::[::::[[:::::::[[:[[[[[[[:[[::[:[[:[~"
