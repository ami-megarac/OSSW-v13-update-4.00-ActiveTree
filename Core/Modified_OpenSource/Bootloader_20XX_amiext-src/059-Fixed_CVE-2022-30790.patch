diff -Naur uboot_org/include/net.h uboot/include/net.h
--- uboot_org/include/net.h	2022-06-27 16:31:46.434821000 +0800
+++ uboot/include/net.h	2022-06-29 11:47:27.256617098 +0800
@@ -370,6 +370,8 @@
 
 #define IP_HDR_SIZE		(sizeof(struct ip_hdr))
 
+#define IP_MIN_FRAG_DATAGRAM_SIZE	(IP_HDR_SIZE + 8)
+
 /*
  *	Internet Protocol (IP) + UDP header.
  */
diff -Naur uboot_org/net/net.c uboot/net/net.c
--- uboot_org/net/net.c	2022-06-27 16:31:46.574821000 +0800
+++ uboot/net/net.c	2022-06-29 11:49:33.088827839 +0800
@@ -951,6 +951,10 @@
 	int offset8, start, len, done = 0;
 	u16 ip_off = ntohs(ip->ip_off);
 
+	if (ip->ip_len < IP_MIN_FRAG_DATAGRAM_SIZE)
+		return NULL;
+
+
 	/* payload starts after IP header, this fragment is in there */
 	payload = (struct hole *)(pkt_buff + IP_HDR_SIZE);
 	offset8 =  (ip_off & IP_OFFS);
