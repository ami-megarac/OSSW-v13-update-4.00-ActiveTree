--- linux_patch273/net/netfilter/nfnetlink_osf.c	2023-10-19 11:16:37.476214298 +0800
+++ linux/net/netfilter/nfnetlink_osf.c	2023-10-19 11:53:28.105325907 +0800
@@ -316,6 +316,14 @@
 
 	f = nla_data(osf_attrs[OSF_ATTR_FINGER]);
 
+	if (f->opt_num > ARRAY_SIZE(f->opt))
+		return -EINVAL;
+
+	if (!memchr(f->genre, 0, MAXGENRELEN) ||
+	    !memchr(f->subtype, 0, MAXGENRELEN) ||
+	    !memchr(f->version, 0, MAXGENRELEN))
+		return -EINVAL;
+
 	kf = kmalloc(sizeof(struct nf_osf_finger), GFP_KERNEL);
 	if (!kf)
 		return -ENOMEM;
